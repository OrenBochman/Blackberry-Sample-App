<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML> 
<HEAD> 
<TITLE>U.S. Department of Labor -- The Department of Labor Developer Community</TITLE>
<META NAME="keywords" CONTENT="Department of Labor, DOL, Secretary of Labor" />
<!-- begin dol-styles.shtm -->
<link rel="shortcut icon" href="http://www.dol.gov/favicon.ico" type="image/x-icon">
<link rel="icon" href="http://www.dol.gov/favicon.ico" type="image/x-icon">
<link href="http://www.dol.gov/dol.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="api.css" TYPE="text/css" />
<link href="http://webapps.dol.gov/FSPublic/Content/W_Helpful.css" rel="stylesheet" type="text/css">
<style type="text/css">
<!--
caption {text-align:left; font-size:80%}
table{margin-left:12px;}


-->
</style>

<!-- end dol-styles.shtm -->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script type="text/javascript" src="prettify.js"></script>
<script language="JavaScript" type="text/javascript">

	jQuery(document).ready(function(){

		// This line of code makes code pretty to look at and understand.
		window.prettyPrint && prettyPrint()
	
	});
	


</script>
<!--start include header-dest-redesign3.shtm -->
<script src="http://webapps.dol.gov/FSPublic/Scripts/W_Helpful.js" type="text/javascript"></script>
<script type="text/javascript">
		$(document).ready(function() {
			W_Helpful.init('#fbcontent');
		});
</script> 
</HEAD> 
<BODY> 
<a href="https://github.com/USDepartmentofLabor/Blackberry-Sample-App"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
<div id="Main">
	<!--Header Start -->
    <a href="#pagecontent" class="skipster">Skip to page content</a>

<div id="Header">
    <div id="Banner">
        <p class="banner"><a href="http://www.dol.gov">United States Department of Labor</a></p>
    </div>
		<div id="RightColumn"><table><tr><td valign="bottom">
		
			</td><td>
            
  
 
 
            
            
          </td></tr>
		  <tr><td colspan="2">
			<!--<div id="Nav" class="navlinks">
				<a href="http://www.dol.gov/dol/siteindex.htm">A to Z</a>&nbsp;|&nbsp;
				<a href="http://www.dol.gov/dol/findit.htm">Site Map</a>&nbsp;|&nbsp;
				<a href="http://webapps.dol.gov/dolfaq/dolfaq.asp">FAQs</a>&nbsp;|&nbsp;

				<a href="http://webapps.dol.gov/libraryforms">Forms</a>&nbsp;|&nbsp;
				<a href="http://www.dol.gov/dol/aboutdol/main.htm">About DOL</a>&nbsp;|&nbsp; 
				<a href="http://www.dol.gov/dol/contact">Contact Us</a>&nbsp;|&nbsp;
                		<a href="http://www.dol.gov/dol/topic/Spanish-speakingTopic.htm">Espa&#241;ol</a>
			</div>

			--></td></tr></table>
		</div>
	</div>
    
	<!--Header End -->

	<!--Body Start -->
	<div id="Body">
		<div id="UtilityBar" class="tools">
			<div class="utilitybarleft"><div id="agencyname">&nbsp;</div></div>

			<!-- This is where the E-mail This page use to be -->
			<div class="utilitybarright">
				<div id="fbcontent" style="float:right"></div>			
			</div>
		</div>
		<div class="crumb-links"><!-- begin crumb-nonav-auto.shtm -->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
  <TR>
    <TD VALIGN="middle" ALIGN="LEFT" height="7" style="padding-left:2px"><span class="crumb-links">
      <a href="http://www.dol.gov">DOL Home</a> &gt; <a href="http://www.dol.gov/open/">OPEN</a> &gt; <a href="http://developer.dol.gov">Developer Community</a> &gt; BlackBerry DOL Data SDK Sample
      </span> </td>

  </tr>
</table>
<!-- end crumb-nonav-auto.shtm --></div>
		<div id="content" >
			<div id="pagecontent" style="width:768px;font-size:0;line-height:0;"></div>

<!--end include header-dest-redesign3.shtm -->
<!-- START CONTENT HERE  *************************************************** -->


<h1>BlackBerry DOL Data SDK Sample</h1>

<h2>Overview</h2>
<p>
This sample will provide the steps to create a simple BlackBerry application that can consume Government Entity Data. 
Following these steps in order will allow your application to operate correctly.  
<a href="https://github.com/USDepartmentofLabor/Blackberry-Sample-App">Download this project</a><br>
</p>
<p>This solution was built using:</p>
<ul>
<li>Eclipse JEE Helio SR2 windows 32</li>
<li><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK</a></li>
<li><a href="http://us.blackberry.com/developers/javaappdev/javaupdate.jsp">BlackBerry SDK</a></li>
<li>BlackBerry JRE 5.0.0 - The BlackBerry JRE is included in the BlackBerry SDK.  This is the JRE version this application will need to build correctly.</li>
</ul>
<br>
<h2>Download BlackBerry SDK</h2>
<p>

Installation instructions are provided in detail <a href="http://us.blackberry.com/developers/javaappdev/javaupdate.jsp">here</a> to setup a BlackBerry development environment.  
After installation it is important to follow the steps for installing plug-in updates and additional components.  This page will be visible in the Eclipse startup screen.<br><br>
<img alt="Select Workspace" src="images/AddDeviceSDK.png" />
<br><br>
</p>
<br>

<h2>Create a New Project</h2>
<p>
For this sample we are going to create a new BlackBerry application that will consume and list Agency data.<br><br>
Start by creating a new workspace or selecting a workspace of your choice.  <br><br>
Then open a new project by Clicking <strong>File  >  New Project > BlackBerry Project</strong>.<br><br>
<img alt="New Project" src="images/NewProject.png"  /><br><br>

You will need to provide information in order to proceed.
</p>
<ul>
<li>Choose a <strong>project name</strong>; this will be displayed as the root item in your project.</li>
</ul>
<p>
For this project, BlackBerry JRE 5.0.0 platform has been used.<br>
<strong>Currently BlackBerry JRE 6.0.0 and 7.0.0 are not supported.</strong><br><br>
<img alt="Create BlackBerry Project " src="images/ProjectDetails.png" WIDTH="60%" /><br><br>
</p>
<br>

<h2>Add SDK to Project</h2>
<p>
All requests require account credentials to be submitted along with the request.  
This SDK contains a few classes needed to process service requests.  
This package needs to be imported into your project.  You can grab the <a href="https://github.com/USDepartmentofLabor/BlackBerry_GOVDataSDK">Git repository</a>.<br><br>
<img alt="Add SDK File,Import SDK files into Project" src="images/AddSdk.png"  /><br><br>
Import the BlackBerry_GOVDataSDK into your project using the <strong>General > File System</strong> option.<br><br>

<img alt="Import SDK using General > File System option " src="images/AddSdk2.png"  /><br><br>

Choose the root path and click ok.<br><br>

<img alt="Choose root path" src="images/AddSdk3.png"  /><br><br>
</p>
<br>

<h2>Locate the Dataset Path</h2>
<p>
Each Dataset has a Dataset Location path that gives the URL that will be needed to reach the Dataset on the API. For this sample please we're using http://api.dol.gov/V1/DOLAgency.<br><br>
<img alt="Add Service Reference" src="images/DatasetLocation.png" WIDTH="60%"  /><br><br>
</p>
<br>

<p>
    For the DOL Service Operation sample please use http://api.dol.gov/V1/SummerJobs.<br><br>

<br>
</p>

<h2>Define the User Interface</h2>
<p>
BlackBerry allows developers to add UI Components to the main screen programmatically.  
By Creating a <strong>ButtonField</strong> member variable in this application, users will be able to invoke a call to the DOL Data API.  
We will implement the FieldChangeListener to handle the button click events.  
We will also implement the GOVDataRequestCallBack to handle request made to the DOL Data API.
<br><br>
<pre class="prettyprint">public final class GOVDataMainScreen extends MainScreen implements FieldChangeListener, GOVDataRequestCallBack

    /**
     * Creates a new DolDataMainScren object
     */

	// You will need to supply your own key and secret.
	public final String API_KEY =  "";
	public final String SHARED_SECRET = "";
    public final String API_URI = "V1";
    public final String API_HOST = "http://api.dol.gov";
    public final String  API_DATA = "DOLAgency/Agencies";
	
</pre><br>
<p>The example above uses DOL's API.  Some federal APIs' URLs are structured differently.  For example, let's look at http://business.usa.gov/api/article/xml
<ul>
	<li>API_LOGIN = ""</li>
    <li>API_KEY = ""</li>
	<li>SHARED_SECRET = ""</li>
	<li>API_HOST = "http://business.usa.gov"</li>
	<li>API_URI = "/api"</li>
	<li>API_DATA = "/article/xml"</li>
</ul></p>

<p>Let's look at the Census Bureau.  For example, http://api.census.gov/data/2010/acs5?key={your key}&get=B02001_001E,NAME&for=state:06,36
<ul>
    <li>API_LOGIN = ""</li>
	<li>API_KEY = "key={your key}"</li>
	<li>API_SECRET = ""</li>
	<li>API_Host = "http://api.census.gov"</li>
	<li>API_URI = "/data"</li>
	<li>API_DATA = "/2010/sf1"</li>
</ul></p>

<p>Implementation for initializing this button is placed in the class constructor to be executed only once.
</p><br>
<pre class="prettyprint">//GOV Data Context object
private GOVDataContext context;

private ButtonField submitButton;
 
public GOVDataMainScreen()
{
	//Instantiate GOV Data context object
    	//This object stores the API information required to make requests
    	context = new GOVDataContext(API_KEY, SHARED_SECRET, API_HOST, API_URI,API_LOGIN, API_DATA);
 
	// Set the displayed title of the screen
	setTitle(“Events”);
 
	//Create the search button. Add click event. Center it.
	submitButton = new ButtonField(“Call API”,ButtonField.CONSUME_CLICK | ButtonField.FIELD_CENTER);
	//Set delegate for button presses to be the same class (this)
	//It will trigger “public void vieldChanged(Field field, int context” when pressed
	submitButton.setChangeListener(this);
 
	//Add the search button
	add(submitButton);
}</pre><br><br>
<br><br>


</p>
<br>

<h2>Implementing the GOV Data Request</h2>
<p>
DOL Data Request logic has been placed in the <strong>fieldChanged</strong> method to respond to the button's click event.  
The <strong>String method</strong> variable represents the Dataset and the table portion of the Data location path.<br><br>
-Format( Dateset/Table) i.e. "DOLAgency/Agencies", "FORMS/AgencyFormsTable", "FAQ/Topics", "FAQ/SubTopics".<br><br>
<sup>*</sup>Please Note: these paths are <strong>case sensitive</strong>, please refer to the corresponding Datasets for the correct formats. 
<br><br>
For DOL API dataset :

<br><br>

<pre class="prettyprint">public void fieldChanged(Field arg0, int arg1) {
	//Update the status field to give user feedback of what is occurring (searching)
	LabelField status = new LabelField(“Searching...”,LabelField.ELLIPSIS | LabelField.USE_ALL_WIDTH);
	setStatus(status);
 
	//Catch any exceptions
	try
	{
		//Instantiate new request object. Pass the context ivar that contains all the API key info
		GOVDataRequest request = new GOVDataRequest(this, context);
		String method = API_DATA;
 
		Hashtable args = new Hashtable(2);
 
		args.put(“top”, “20”);
		//args.put(“filter”, “CURRENT_MINE_NAME eq ‘Rockwood Mine’”);
 
		request.callAPIMethod(method, args);
	}
	catch (Exception e) {
		//Alert the user that an error occurred
		Dialog.alert(e.getMessage());
		//Clear status bar
		setStatus(null);
	}
}</pre><br><br>

<br> 
For  DOL service operation :

<br><br>

<pre class="prettyprint">public void fieldChanged(Field arg0, int arg1) {
	//Update the status field to give user feedback of what is occurring (searching)
	LabelField status = new LabelField("Searching...",LabelField.ELLIPSIS | LabelField.USE_ALL_WIDTH);
	setStatus(status);
	//Cacth any exceptions
	try
	{
		//Instantiate new request object. Pass the context ivar that contains all the API key info
		GOVDataRequest request = new GOVDataRequest(this, context);
		String method = API_DATA;
		
		Hashtable args = new Hashtable(7);
		
		args.put("format", "'json'");
		args.put("query", "'farm'");
		args.put("region", "");
		args.put("locality", "");
		args.put("skipCount", "1");
		
		request.callAPIMethod(method, args);
	}
	catch (Exception e) {
		//Alert the user that an error has occurred
		Dialog.alert(e.getMessage());
		//Clear status bar
		setStatus(null);
	}
}</pre><br><br>

The results from the request are implemented in the <strong>GOVDataResultsCallBack</strong> method. The request results of the DOL Data API are iterated through and a label is created for each item in the list.  We also have the <strong>GOVDataResultsCallbackText</strong> method when the SDK fails to parse the returned data.
<br><br>For DOL API dataset :<br><br>
<pre class="prettyprint">public void GOVDataResultsCallback(Vector results) {
	for (int i = 0; i < results.size(); i++) {
		Hashtable record = (Hashtable)results.elementAt(i);
		LabelField l = new LabelField(record.get(“Agency”)+” - “+record.get(“AgencyFullName”),FOCUSABLE);
		add(l);
	}
 
	//Clear status bar
	setStatus(null);
}

	public void GOVDataResultsCallbackText(String results) {
		
	
	    LabelField l = new LabelField(results);
		
	    	add(l);
	 //Clear status bar
		setStatus(null);
	
	}</pre><br><br>
For DOL service operation:<br><br>
<pre class="prettyprint">public void GOVDataResultsCallback(Vector results) {
	//Create JSON object and JSONArray to store the data from DOL service operation
	JSONObject jsonObject = null;
	JSONArray subArray = null;
	//Iterate through list of results.  Add each field to the display list.
	for (int i = 0; i &lt; results.size(); i++) {
		try {
			if(null != results.elementAt(i))
			{
				Hashtable record = (Hashtable)results.elementAt(i);
				//Look for value of getJobsListing property.
				if(record.get("getJobsListing") != null)
				{
					String jobs = record.get("getJobsListing").toString();
					//Cleanup json result
					jobs = replaceAll(jobs, "\\n", "");
					jobs = replaceAll(jobs, "\\\", "\"");
					jobs = replaceAll(jobs, "\"{", "{");
					jobs = replaceAll(jobs, "}\"", "}");
					//convert jString to the jObject
					//start extracting the content from jObject
					jsonObject = new JSONObject(jobs);
					if(null!=jsonObject)
					{
						//Look for an array of "item"
						subArray = jsonObject.getJSONArray("items");
						if(null!=subArray)
						{
							//Let's loop through each job
							for(int j=0; j &lt; subArray.length(); j++)
							{
								//get the job title
								String str = subArray.getJSONObject(j).getString("title");
								LabelField l = new LabelField(subArray.getJSONObject(j).getString("title"),FOCUSABLE);
								add(l);
							}
						}
					}
				}
			}
		} catch (JSONException e) {
			e.printStackTrace();
		}
	}
	setStatus(null);
}</pre><br><br>

Requests resulting in error, are sent to the <strong>GOVDataErrorCallBack</strong> method with information pertaining to the error.
<br><br>
<pre class="prettyprint">public void(GOVDataErrorCallback(String error) {
	Dialog.alert(error);
	//Clear status bar
	setStatus(null);
}</pre><br><br>
</p>
<br>



<h2>Run the Application</h2>
<p>
If you are not using a BlackBerry device, you will need to run this application in the Simulator. 
Press <strong>F11</strong> or <strong>Run > Debug</strong> to run this application in debug mode.  You will be prompted to choose either a BlackBerry Device or Simulator.  
When the Simulator is fully active, goto the <strong>Downloads icon</strong> in the menu and click on the application to run.
A list of Agencies should be displayed on the screen.<br><br>
For DOL API dataset : <br /><br />
<img alt="Run application and screen should display list of Agencies" src="images/Data.png" />
<br /><br />For DOL service operation : <br /><br />
<img alt="Run application and screen should display list of jobs" src="images/summer_jobs_blackberry_result.png" />
</p>





<!-- END CONTENT HERE  *************************************************** -->
<!---original location of this file: "/includes/" -->


<!-- END CONTENT HERE  *************************************************** -->
<!---original location of this file: "/includes/" -->

</div><!--Body End -->

 </div>

	<!--Footer Start -->
	<div id="Footer">
		<div id="FooterMenu">
			<div id="FooterMenuContainer">
				<a href="http://www.dol.gov/dol/foia/main.htm">Freedom of Information Act</a>&nbsp;|&nbsp;

				<a href="http://www.dol.gov/dol/privacynotice.htm">Privacy & Security Statement</a>&nbsp;|&nbsp;
				<a href="http://www.dol.gov/dol/disclaim.htm">Disclaimers</a>&nbsp;|&nbsp;
				<a href="http://webapps.dol.gov/feedback/FeedbackSurvey.aspx">Customer Survey</a>&nbsp;|&nbsp;
				<a href="http://www.dol.gov/dol/aboutdol/website-policies.htm">Important Web Site Notices</a>&nbsp;|&nbsp;

                <a href="http://www.dol.gov/dol/aboutdol/plug-ins.htm">Plug-ins Used by DOL</a>
			</div>
		</div>
	
		<div id="FooterContact">
			<div id="FooterContactContainer">
				U.S. Department of Labor&nbsp;|&nbsp;Frances Perkins Building, 200 Constitution Ave., NW, Washington, DC 20210<br>

				<a href="http://www.dol.gov" style=" text-decoration: underline; ">www.dol.gov</a>&nbsp;|&nbsp;Telephone: 1-866-4-USA-DOL (1-866-487-2365)&nbsp;|&nbsp;TTY: 1-877-889-5627&nbsp;|&nbsp;<u><a href="http://www.dol.gov/dol/contact/index.htm">Contact Us</a></u>
			</div>
		</div>
	</div>
	<!--Footer End -->


</div><!--Main End -->

  </BODY>
</HTML>